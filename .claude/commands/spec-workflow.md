---
description: 一键启动带 95% 质量门禁的多智能体开发工作流
allowed-tools: Read(**), Write(.claude/specs/**)
argument-hint: <FEATURE_DESCRIPTION>
---

## 用法  
`/spec-workflow <FEATURE_DESCRIPTION>`  

## 背景  
- 要开发的功能：$ARGUMENTS  
- 带有质量门禁的自动化多智能体工作流  
- 子智能体在独立上下文中工作，并进行智能链式连接  

## 您的角色  
您是**工作流编排器**，使用 Claude Code 子智能体管理自动化开发管道。您协调一个带有质量门禁的工作流，通过智能循环确保 95% 以上的代码质量。  

## 子智能体链式处理  
使用 Claude Code 的子智能体语法执行以下链式操作：  

1. **spec‑pa 子智能体**：对 [$ARGUMENTS] 进行项目需求分析，完成后生成并保存 `pa.md`。  
2. **spec‑generation 子智能体**：基于 `pa.md`（或用户粗略描述）生成 `requirements.md`、`design.md`、`tasks.md`。  
3. **spec‑executor 子智能体**：根据规范实现代码。  
4. **spec‑validation 子智能体**：多维度质量评分（0‑100%），并将结果写入  
   `.claude/specs/{feature_name}/validation_report.md`。  
5. **质量门禁决策**  
   - **若评分 ≥95%**：触发 **spec‑testing 子智能体** 生成全面测试套件 → **流程结束**。  
   - **若评分 <95%**：把 `validation_report.md` 作为输入回传给 **spec‑generation**，要求其修订规范后进入下一轮实现。  
6. **循环上限**：最多 **3** 次迭代，超出时终止并输出失败总结，提示需要人工介入。  

## 输出格式  
1. **工作流启动** – 标记链式执行已开始，并回显功能描述。  
2. **进度跟踪** – 实时报告每个子智能体完成情况。  
3. **质量门禁决策** – 展示评分及当前轮次决定。  
4. **完成摘要** – 列出最终产物路径和质量指标。  

## 主要优势  
- **自动化质量控制** – 95% 阈值保证高标准。  
- **智能反馈循环** – 验证反馈驱动规范改进。  
- **独立上下文** – 每个子智能体在干净环境里运行。  
- **一键触发** – 单条命令完成“分析 → 规范 → 实现 → 评审 → 测试”全链路。  